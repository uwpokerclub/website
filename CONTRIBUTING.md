# Contributing to UWPSC Website

Thank you for your interest in contributing to the UWPSC Website! This document provides guidelines and instructions for contributing to the project.

## Table of Contents

- [Getting Started](#getting-started)
- [Development Workflow](#development-workflow)
- [Code Standards](#code-standards)
- [Database Changes](#database-changes)
- [Testing Guidelines](#testing-guidelines)
- [Pull Request Process](#pull-request-process)
- [Issue Reporting](#issue-reporting)

## Getting Started

1. **Fork the repository** on GitHub
2. **Clone your fork** locally:
   ```bash
   git clone https://github.com/your-username/website.git
   cd website
   ```
3. **Set up the development environment**:
   ```bash
   # Create Docker network
   docker network create uwpokerclub_services_network
   
   # Start all services
   docker-compose up -d
   ```
4. **Create a new branch** for your feature:
   ```bash
   git checkout -b feature/your-feature-name
   ```

## Development Workflow

### Branch Naming Convention
- `feature/description` - New features
- `bugfix/description` - Bug fixes
- `hotfix/description` - Critical fixes
- `docs/description` - Documentation updates
- `refactor/description` - Code refactoring

### Commit Message Format
We follow the [Conventional Commits](https://www.conventionalcommits.org/) specification:

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**Types:**
- `feat:` - New feature
- `fix:` - Bug fix
- `docs:` - Documentation changes
- `style:` - Code style changes (formatting, etc.)
- `refactor:` - Code refactoring
- `test:` - Adding or updating tests
- `chore:` - Maintenance tasks

**Examples:**
```
feat(api): add tournament bracket generation
fix(webapp): resolve login form validation
docs: update migration guide for Atlas
```

## Code Standards

### Go (Backend)
- **Formatting**: Use `gofmt` and `goimports`
- **Linting**: Code should pass `golangci-lint`
- **Naming**: Follow Go naming conventions
- **Error Handling**: Always handle errors appropriately
- **Comments**: Document exported functions and types

```go
// Example: Good function documentation
// CreateEvent creates a new poker event with the provided details.
// It validates the input, checks user permissions, and returns the created event.
func (es *eventService) CreateEvent(req *models.CreateEventRequest) (*models.Event, error) {
    // Implementation...
}
```

### TypeScript/React (Frontend)
- **Formatting**: Use Prettier with the project configuration
- **Linting**: Code should pass ESLint rules
- **Types**: Use TypeScript for all new code
- **Components**: Use functional components with hooks
- **Props**: Define interfaces for component props

```typescript
// Example: Component with proper typing
interface EventCardProps {
  event: Event;
  onEdit?: (event: Event) => void;
  onDelete?: (eventId: string) => void;
}

export const EventCard: React.FC<EventCardProps> = ({ event, onEdit, onDelete }) => {
  // Implementation...
};
```

### Database (GORM Models)
- **Constraints**: Use proper GORM tags for constraints
- **Relationships**: Define relationships clearly
- **Validation**: Add appropriate validation tags
- **Naming**: Use consistent naming conventions

```go
// Example: Well-structured GORM model
type Event struct {
    ID               uint      `json:"id" gorm:"type:serial;primaryKey"`
    Name             string    `json:"name" gorm:"not null"`
    StartDate        time.Time `json:"startDate" gorm:"not null;default:CURRENT_TIMESTAMP"`
    SemesterID       uuid.UUID `json:"semesterId" gorm:"type:uuid"`
    Semester         Semester  `json:"semester"`
}
```

## Database Changes

### Using Atlas for Schema Changes

1. **Modify GORM models** in `server/internal/models/`
2. **Generate migration**:
   ```bash
   cd server
   atlas migrate diff migration_name \
     --dir "file://atlas/migrations" \
     --to "atlas://gorm" \
     --dev-url "docker://postgres/17/dev?search_path=public"
   ```
3. **Review the generated migration** in `atlas/migrations/`
4. **Test the migration**:
   ```bash
   docker-compose run --rm atlas-migrate
   ```

### Guidelines
- **Always backup** before applying migrations in production
- **Test migrations** on a copy of production data
- **Review SQL** generated by Atlas before committing
- **Avoid breaking changes** when possible
- **Use descriptive migration names**

## Testing Guidelines

### Backend Tests
- **Unit Tests**: Test individual functions and methods
- **Integration Tests**: Test API endpoints and database interactions
- **Test Coverage**: Aim for >80% coverage on new code
- **Test Data**: Use the `testhelpers` package for consistent test data

```go
func TestEventService_CreateEvent(t *testing.T) {
    // Setup
    db, cleanup := testhelpers.SetupTestDB(t)
    defer cleanup()
    
    service := NewEventService(db)
    
    // Test cases...
}
```

### Frontend Tests
- **Component Tests**: Test React components in isolation
- **Integration Tests**: Test user interactions and flows
- **Type Safety**: Ensure TypeScript compilation passes
- **Accessibility**: Test with screen readers and keyboard navigation

### End-to-End Tests
- **Cypress Tests**: Test complete user workflows
- **Real Data**: Use realistic test data scenarios
- **Cross-Browser**: Test on different browsers and devices

## Pull Request Process

### Before Submitting
1. **Run tests**: Ensure all tests pass
   ```bash
   # Backend tests
   docker-compose exec server go test ./internal/... -v -p=1
   
   # Frontend tests
   cd webapp && npm test
   
   # E2E tests
   npm run test
   ```

2. **Check code quality**:
   ```bash
   # Go formatting
   cd server && gofmt -w .
   
   # Frontend formatting
   cd webapp && npm run lint:fix
   ```

3. **Update documentation** if needed

### PR Description Template
```markdown
## Description
Brief description of changes

## Type of Change
- [ ] Bug fix
- [ ] New feature
- [ ] Breaking change
- [ ] Documentation update

## Testing
- [ ] Unit tests pass
- [ ] Integration tests pass
- [ ] E2E tests pass
- [ ] Manual testing completed

## Database Changes
- [ ] No database changes
- [ ] Migration included and tested
- [ ] Atlas migration generated

## Checklist
- [ ] Code follows project style guidelines
- [ ] Self-review completed
- [ ] Tests added for new functionality
- [ ] Documentation updated
```

### Review Process
1. **Automated Checks**: CI/CD pipeline runs tests and linting
2. **Code Review**: At least one team member reviews changes
3. **Manual Testing**: Reviewer tests functionality if needed
4. **Approval**: PR approved by maintainer
5. **Merge**: Squash and merge to main branch

## Issue Reporting

### Bug Reports
Use the bug report template and include:
- **Steps to reproduce**
- **Expected behavior**
- **Actual behavior**
- **Environment details** (browser, OS, etc.)
- **Screenshots** if applicable

### Feature Requests
- **Clear description** of the feature
- **Use case** and business justification
- **Proposed implementation** (if you have ideas)
- **Alternative solutions** considered

### Security Issues
- **Do not** open public issues for security vulnerabilities
- **Email** the team at uwaterloopoker@gmail.com
- **Provide details** about the vulnerability
- **Allow time** for the team to respond and fix

## Development Environment Setup

### Required Tools
- Docker and Docker Compose
- Go 1.24+
- Node.js 18+
- Atlas CLI
- Git

### Useful Commands
```bash
# Start development environment
docker-compose up -d

# View logs
docker-compose logs -f [service-name]

# Run migrations
docker-compose run --rm atlas-migrate

# Generate API docs
docker-compose run --rm generate-api-docs

# Reset database
npm run db:reset

# Seed test data
npm run db:seed
```

## Questions?

- **Documentation**: Check the main [README.md](README.md)
- **Discord**: Join our development Discord server
- **Email**: Contact uwaterloopoker@gmail.com
- **Issues**: Search existing issues or create a new one

Thank you for contributing to the UWPSC Website! üé∞‚ô†Ô∏è‚ô•Ô∏è‚ô¶Ô∏è‚ô£Ô∏è
